<!DOCTYPE html> <html lang="en"> <style> :root { --primary-color: rgba(10, 10, 72, 0.55);; --overlay-color: rgba(24, 39, 51 , 0.85); --menu-speed: 0.75s; } .container-show { max-width: 105rem; margin: auto; overflow: hidden; padding: 0 3rem; } .showcase { background: #fff; height: 90vh; position: relative; } .showcase:before { content: ''; background: #fff; position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; } .showcase .showcase-inner { display: flex; flex-direction: row; align-items: center; justify-content: center; height: 100%; } .showcase h1 { font-size: 8rem; line-height: 1; } .showcase p { font-size: 2rem; } .logo{ font-family: Gotham XNarrow; text-transform: uppercase; } </style> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="p:domain_verify" content="24f4001fe32c84cdbe8a07fc24fdeecd"/> <title>ML CHALLENGE - CHURN MODELLING | The Analytics Bay</title> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>ML CHALLENGE - CHURN MODELLING | The Analytics Bay</title> <meta name="generator" content="Jekyll v4.1.1" /> <meta property="og:title" content="ML CHALLENGE - CHURN MODELLING" /> <meta name="author" content="Shivansh Mehendiratta" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Sometime back we started with our Voyage-à-Machine-Learning series to provide an opportunity for everyone to know all about Machine Learning and its applications. It culminated with a small challenge involving the use of various techniques covered in the series." /> <meta property="og:description" content="Sometime back we started with our Voyage-à-Machine-Learning series to provide an opportunity for everyone to know all about Machine Learning and its applications. It culminated with a small challenge involving the use of various techniques covered in the series." /> <link rel="canonical" href="http://localhost:4000/blog/ML-CHALLENGE-CHURN-MODELLING/" /> <meta property="og:url" content="http://localhost:4000/blog/ML-CHALLENGE-CHURN-MODELLING/" /> <meta property="og:site_name" content="The Analytics Bay" /> <meta property="og:image" content="http://localhost:4000/bg.jpeg" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2020-07-28T00:00:00+05:30" /> <meta name="twitter:card" content="summary_large_image" /> <meta property="twitter:image" content="http://localhost:4000/bg.jpeg" /> <meta property="twitter:title" content="ML CHALLENGE - CHURN MODELLING" /> <meta name="twitter:site" content="@shivansh3121" /> <meta name="twitter:creator" content="@shivansh3121" /> <script type="application/ld+json"> {"@type":"BlogPosting","headline":"ML CHALLENGE - CHURN MODELLING","dateModified":"2020-07-28T00:00:00+05:30","datePublished":"2020-07-28T00:00:00+05:30","url":"http://localhost:4000/blog/ML-CHALLENGE-CHURN-MODELLING/","image":"http://localhost:4000/bg.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/ML-CHALLENGE-CHURN-MODELLING/"},"author":{"@type":"Person","name":"Shivansh Mehendiratta"},"description":"Sometime back we started with our Voyage-à-Machine-Learning series to provide an opportunity for everyone to know all about Machine Learning and its applications. It culminated with a small challenge involving the use of various techniques covered in the series.","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <link rel="shortcut icon" href="/img/favicon.png"> <link rel="stylesheet" href="/main.css"> <link href='https://olifro.st/feed.xml' rel='alternate' type='application/atom+xml'> <meta name="theme-color" content="#020cfa"> </head> <body> <div class="menu-wrap"> <input type="checkbox" class="toggler"> <div class="hamburger"><div></div></div> <div class="menu"> <div> <div> <ul> <li><a href="/blog">Blog</a></li> <li><a href="/about">About</a></li> <li><a href="/contact">Contact Us</a></li> </ul> </div> </div> </div> </div> <div class="bar container" style="top:0; border-bottom: 5px solid #bb71f8;"><a href="/"><div class="logo" style=" padding: 30px 0;">The Analytics Bay</div></a><ul class="specialul"> <li><a href="/contact">Contact Us</a></li> <li><a href="/about">About</a></li> <li><a href="/blog">Blog</a></li> </ul></div> <main class="content"> <div class="container" style="margin-top: 80px"> <a href="/blog/">← All Posts</a> / <time datetime="2020-07-28T00:00:00+05:30" class="post-date">28 Jul 2020</time> <article class="post"> <h1 class="post-title">ML CHALLENGE - CHURN MODELLING</h1> <p></p> <p class="post-description"><p>Sometime back we started with our Voyage-à-Machine-Learning series to provide an opportunity for everyone to know all about Machine Learning and its applications. It culminated with a small challenge involving the use of various techniques covered in the series.</p> </p> <p><p><img src="/blog/2020-07-28-ML CHALLENGE - CHURN MODEL/ML CHALLENGE – CHURN MODEL.jpg" alt="ML Challenge" /> The topics covered in the series were,</p> <p>All about Machine Learning Random Forest Logistic Regression K-Nearest Neighbours Support Vector Machines (SVMs) Clustering Association rule learning with Apriori Deep Learning and AI To provide hands on practice so that our followers can now learn while practicing we opened a Machine Learning Challenge based on Churn Modelling. An important area of operation of banks is Churn Analysis. Churn Modelling or Analysis is the evaluation of the customer loss rate in order to reduce it. Banks are intrigued to identify segments of such customer as the cost for associating with a new customer is usually higher than retaining the old one.</p> <p>For this challenge, a dataset was provided wherein, a Bank is witnessing some unusual churn rates and thus they want to predict whether a customer will leave the bank or not, based on the data provided.</p> <p>The winner of the Challenge, Soham Mukherjee, majorly performed following 4 steps to solve this Challenge-</p> <ol> <li> <p>Exploratory Data Analysis</p> </li> <li> <p>Data Pre-Processing</p> </li> <li> <p>Data Modelling</p> </li> <li> <p>Boosting Techniques</p> </li> </ol> <p>Exploratory Data Analysis (EDA) Imagine your friends decide to go out for dinner to a restaurant you have never heard of before. Being a foodie, you will straight away find yourself perplexed with several questions. As a rule of thumb, you would go online to check for menu, reviews, and ratings. Furthermore, you will dig out details on the experience of people from the restaurant.</p> <p>Whatever research you will undertake before finally booking your table for the dinner is nothing but what Data Scientists in their language call “Exploratory Data Analysis”</p> <p>EDA refers to the analytical procedure of performing preliminary investigations on data in order to discover patterns, to detect abnormalities in data, to test hypothesis and to check assumptions with the support of insights on synopsis and graphical representations of data provided.</p> <p>In this case, our Winner performed multiple EDA techniques including checking for skewness, visualizing with help of histogram plots, and checking the relationship between variables. Further distribution of dependent variable was depicted using a pie chart.</p> <p>Data is always first available in human readable form due to which the data is labelled with words. However, Label Encoding is applied to convert the words into numeric values and make the data in machine-readable form. Therefore, the categorical variables (Geography, Gender) were first encoded with the help of following code- <img src="/blog/2020-07-28-ML CHALLENGE - CHURN MODEL/Winner_s Python code/1.png" alt="ML Challenge" /></p> <p>Once data was verified for duplications, the participant checked the skewness of the variables and then further illustrated the frequency-variable chart for each variable as shown below- <img src="/blog/2020-07-28-ML CHALLENGE - CHURN MODEL/Winner_s Python code/2.png" alt="ML Challenge" /></p> <p>Then, some detailed visualizations were prepared with help of Pair Plots. One of the most significant analysis is to check the relationship between the two variables. To accomplish that so that further decisions could be made, a heat map was plotted that illustrating the correlation between the variables- <img src="/blog/2020-07-28-ML CHALLENGE - CHURN MODEL/Winner_s Python code/3.png" alt="ML Challenge" /></p> <p>Since Correlation of X with itself is always 1, we get a diagonal which divides data into two triangles.</p> <p>Now that Exploratory Data Analysis has been performed and required results fetched, by going into the intricacies of data with help of certain visualizations, the next step would be Data Pre-processing to make data fit for Machine Learning Modelling.</p> <p>Data Pre-processing This stage is one of the most significant steps in Machine Learning and no data scientist can ever skip this step in his/her analysis.</p> <p>To define in simple words, Data Preprocessing is a technique to convert the raw data which has been gathered from numerous sources into cleaner and more meaningful pieces of information. Datasets are incredibly massive and usually contain unnecessary data as well. That vast amount of information is also heterogeneous by nature, which means that they don’t share the same structure and thus there is also a need to standardize the data first. Data Preprocessing technically deals with issues such as inconsistent data, missing values, insufficient data, imbalance data, etc.</p> <p>In the winner’s entry, special attention was given to this step and he removed the “Balance” variable as it would decrease accuracy. It was observed from the correlation matrix between all the variables that Balance variable can reduce the accuracy of model as it was less related to the target and other variables. Further to handle the imbalance and inconsistent data following two techniques were performed-</p> <p>SMOTE for Handling Imbalanced Data- Data imbalance usually reflects an unequal distribution of classes within a dataset and a major issue associated is that there are very few examples of the minority class in data for a model to effectively learn and predict. Therefore, to overcome this issue, one way is to oversample the examples in the minority class. The same can be achieved by replicating examples from the minority class in the training dataset before fitting a model. This can balance the class distribution without providing any additional information to the model. An improvement over replicating examples from the minority class is to synthesize new examples from the minority class.</p> <p>For the same, the most widely used approach to synthesizing new examples is called the Synthetic Minority Oversampling Technique (SMOTE). SMOTE first selects a minority class instance at random and finds its k-nearest minority class neighbours. These synthetic training records are generated by randomly selecting one or more of the k-nearest neighbours for each example in the minority class. After the oversampling process, the data is reconstructed and several classification models can be applied for the processed data. <img src="/blog/2020-07-28-ML CHALLENGE - CHURN MODEL/Winner_s Python code/4.png" alt="ML Challenge" /></p> <p>Standardization of Inconsistent Data- The purpose of standardising the dataset is to ensure that each of the variables contributes equally to the analysis without any bias. It becomes essential to do standardization before applying Machine Learning Models as variables are the core of the model and the analysis is pretty much sensitive regarding the variance of initial variables. That is if there are variables with large differences between the initial variables, the variable with larger range will dominate over the smaller ranges.</p> <p>For example, consider two variables, distance within city and distance between cities. One of the variables is measured in meters while the other in Kilometres. Now if the data is not standardised then distance of 500 meters would be considered as greater than distance of 5KM, which isn’t true. Therefore, transforming the data to comparable scales can prevent this problem.</p> <p>Mathematically, it is done by subtracting the mean and dividing by the standard deviation for each value of each variable.</p> <p>z = (value – mean)/ (standard deviation)</p> <p>All the variables will be transformed to the same scale once the standardization is completed. Finally, the data is divided into training and test sets for further steps.</p> <p>Data Modelling This is a technique to analyse data and acquiring certain results from it. There are various data modelling techniques which can be used such as Random Forest Regression, Logistic Regression, K Nearest Neighbours etc. All these techniques can be used to fit in the dataset and then predict the required outcome. For this purpose, dataset is divided into two categories-</p> <p>Train set- For fitting the model. Test set- To predict the required outcome. The various data modelling techniques used in this case are-</p> <p>Logistic Regression Random Forest Classifier Decision Tree Classifier Support Vector Machines K nearest neighbours Here is the code and confusion matrix for the Random Forest Classifier;</p> <p><img src="/blog/2020-07-28-ML CHALLENGE - CHURN MODEL/Winner_s Python code/5.png" alt="ML Challenge" /> Heatmap from the seaborn library has been used in the Confusion Matrix for better understanding-</p> <p>The confusion matrix shows that among all positive predictions, 84.4% of the predictions were true positives and it was correctly predicted that a customer will churn. Rest 15.6% were false positives which means that it was wrongly predicted that these customers will churn.</p> <p>Similarly, out of the negative predictions, 83.8% were true negatives while rest 16.2% were false negatives and they were wrongly predicted. <img src="/blog/2020-07-28-ML CHALLENGE - CHURN MODEL/Winner_s Python code/6.png" alt="ML Challenge" /></p> <p>Boosting Techniques- Boosting techniques helps to convert weak learners into strong learners. The various boosting techniques used in the case are-</p> <p>Gradient Boosting Classifier Ada boost Classifier XG Boost Here is a sample code for Gradient Boosting Classifier <img src="/blog/2020-07-28-ML CHALLENGE - CHURN MODEL/Winner_s Python code/7.png" alt="ML Challenge" /></p> <p>The winner has used certain techniques to increase the accuracy of the model in the XG Boost technique-</p> <p>Random search has been used to find out the best parameters with the help of a Param grid. It searches among a given set of values to find out parameters with highest accuracy. Stratified-K-Fold shuffles the data and then split the dataset into n-splits (specified number of splits) Then it uses each part as a test set. When applying machine learning models, one usually does data pre-processing (as explained above), feature engineering, feature extraction and, feature selection. After this, he/ she selects the best algorithm and tuning of the parameters is done in order to obtain the best results.</p> <p>AutoML is a series of concepts and techniques used to automate these processes. It reduces the bias and errors that occur when a human being is designing the machine learning models. An organization can also reduce the cost of hiring many experts by applying AutoML in their data pipeline. The winner achieved the best accuracy with the help of Stacked Ensemble (Auto ML).</p> <p>We hope that you understood the framework used in order to solve this Challenge. Also, if the training time of model was increased from 5 minutes to probably a couple of hours, the model, the accuracy would have been around a remarkable 94-96%. In case of any queries, feel free to reach out to us.</p> </p> <p><strong>Recommended</strong> <a href="/blog/Turing-Test/">» The Turing Test </a><br> </p> </article> </div> </main> <!-- <footer id="footer"> <div class="row"> <div class="col-xs-12 col-sm-3 footer-social center-xs"> <small class="social"> <div> <span class="icons"> <a href="https://facebook.com/nucleus.cbs"> <span class="icon icon--instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M22.675 0h-21.35c-.732 0-1.325.593-1.325 1.325v21.351c0 .731.593 1.324 1.325 1.324h11.495v-9.294h-3.128v-3.622h3.128v-2.671c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12v9.293h6.116c.73 0 1.323-.593 1.323-1.325v-21.35c0-.732-.593-1.325-1.325-1.325z"/></svg></span></a> <a href="https://www.linkedin.com/company/nucleus-cbs/"> <span class="icon icon--twitter"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg></span></a> <a href="https://instagram.com/nucleus.cbs"> <span class="icon icon--instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg></span></a> </span> <form action="https://formspree.io/xeqrjbrn" method="POST"> <input type="email" name="replyto" id="Email" placeholder="Mailing List Email" class="email" required> <input type="hidden" name="_next" value="https://nucleuscbs.github.io/thanks/" /> <input type="submit" value="Join"> </form> </div> </small> </div> <div class="col-xs-12 col-sm-6 footer"> <h1 style="color: #fff">Collegiate Entrepreneurs Organisation</h1> <h1>Delhi University</h1> </div> <div class="col-xs-12 col-sm-3 footer"> <a href="/noprivacy/">Privacy Policy</a> | &copy; CEO, Delhi University </div> </div> </footer> --> <footer id="footer" style=" display:grid; grid-template-columns: repeat(20,5%); grid-template-rows: repeat(20,5%); height: 40vh; "> <div class="footer-social footer-layout-social"> <small class="social"> <div> <span class="icons"> <a href="https://facebook.com/nucleus.cbs"> <span class="icon icon--instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M22.675 0h-21.35c-.732 0-1.325.593-1.325 1.325v21.351c0 .731.593 1.324 1.325 1.324h11.495v-9.294h-3.128v-3.622h3.128v-2.671c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12v9.293h6.116c.73 0 1.323-.593 1.323-1.325v-21.35c0-.732-.593-1.325-1.325-1.325z"/></svg></span></a> <a href="https://www.linkedin.com/company/nucleus-cbs/"> <span class="icon icon--twitter"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg></span></a> <a href="https://instagram.com/nucleus.cbs"> <span class="icon icon--instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg></span></a> </span> <form action="https://formspree.io/xeqrjbrn" method="POST"> <input type="email" name="replyto" id="Email" placeholder="Mailing List Email" class="email" required> <input type="hidden" name="_next" value="https://nucleuscbs.github.io/thanks/" /> <input type="submit" value="Join"> </form> </div> </small> </div> <div class="footer-layout-text"> <h1 style="color: #000; margin:0; line-height: 1.2; font-family: Gotham XNarrow;letter-spacing: 0.05rem;">THE ANALYTICS BAY</h1> <img src="/nucleus.png" style="height:50px;width:auto;margin-left:0;"> <!-- <h1 style="line-height: 1.2;font-family: Gotham XNarrow;letter-spacing: 0.05rem; font-size: 3rem;color:#000">Nucleus, the analytics society of SSCBS</h1> --> </div> <div class="footer-layout-copy"> &copy; The Analytics Bay </div> </footer> <script async src=""></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); </script> <!-- Rotator --> </body>
