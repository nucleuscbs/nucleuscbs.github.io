<!DOCTYPE html> <html lang="en"> <style> :root { --primary-color: rgba(10, 10, 72, 0.55);; --overlay-color: rgba(24, 39, 51 , 0.85); --menu-speed: 0.75s; } .container-show { max-width: 105rem; margin: auto; overflow: hidden; padding: 0 3rem; } .showcase { background: #fff; height: 90vh; position: relative; } .showcase:before { content: ''; background: #fff; position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; } .showcase .showcase-inner { display: flex; flex-direction: row; align-items: center; justify-content: center; height: 100%; } .showcase h1 { font-size: 8rem; line-height: 1; } .showcase p { font-size: 2rem; } .logo{ font-family: Gotham XNarrow; text-transform: uppercase; } </style> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="p:domain_verify" content="24f4001fe32c84cdbe8a07fc24fdeecd"/> <title>An Introduction To The Confusion Matrix | The Analytics Bay</title> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>An Introduction To The Confusion Matrix | The Analytics Bay</title> <meta name="generator" content="Jekyll v4.1.1" /> <meta property="og:title" content="An Introduction To The Confusion Matrix" /> <meta name="author" content="Shivansh Mehendiratta" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A confusion matrix is a tool used to summarize the performance and accuracy of a classification model in machine learning. It comes in handy after the data has been cleaned, processed, fed into a model, and has given out results. It helps in determining the effectiveness of the classification." /> <meta property="og:description" content="A confusion matrix is a tool used to summarize the performance and accuracy of a classification model in machine learning. It comes in handy after the data has been cleaned, processed, fed into a model, and has given out results. It helps in determining the effectiveness of the classification." /> <link rel="canonical" href="http://localhost:4000/blog/Confusion-Matrix/" /> <meta property="og:url" content="http://localhost:4000/blog/Confusion-Matrix/" /> <meta property="og:site_name" content="The Analytics Bay" /> <meta property="og:image" content="http://localhost:4000/bg.jpeg" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2021-09-02T00:00:00+05:30" /> <meta name="twitter:card" content="summary_large_image" /> <meta property="twitter:image" content="http://localhost:4000/bg.jpeg" /> <meta property="twitter:title" content="An Introduction To The Confusion Matrix" /> <meta name="twitter:site" content="@shivansh3121" /> <meta name="twitter:creator" content="@shivansh3121" /> <script type="application/ld+json"> {"image":"http://localhost:4000/bg.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/Confusion-Matrix/"},"@type":"BlogPosting","url":"http://localhost:4000/blog/Confusion-Matrix/","datePublished":"2021-09-02T00:00:00+05:30","description":"A confusion matrix is a tool used to summarize the performance and accuracy of a classification model in machine learning. It comes in handy after the data has been cleaned, processed, fed into a model, and has given out results. It helps in determining the effectiveness of the classification.","author":{"@type":"Person","name":"Shivansh Mehendiratta"},"headline":"An Introduction To The Confusion Matrix","dateModified":"2021-09-02T00:00:00+05:30","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <link rel="shortcut icon" href="/img/favicon.png"> <link rel="stylesheet" href="/main.css"> <link href='https://olifro.st/feed.xml' rel='alternate' type='application/atom+xml'> <meta name="theme-color" content="#020cfa"> </head> <body> <div class="menu-wrap"> <input type="checkbox" class="toggler"> <div class="hamburger"><div></div></div> <div class="menu"> <div> <div> <ul> <li><a href="/blog">Blog</a></li> <li><a href="/about">About</a></li> <li><a href="/contact">Contact Us</a></li> </ul> </div> </div> </div> </div> <div class="bar container" style="top:0; border-bottom: 5px solid #bb71f8;"><a href="/"><div class="logo" style=" padding: 30px 0;">The Analytics Bay</div></a><ul class="specialul"> <li><a href="/contact">Contact Us</a></li> <li><a href="/about">About</a></li> <li><a href="/blog">Blog</a></li> </ul></div> <main class="content"> <div class="container" style="margin-top: 80px"> <a href="/blog/">← All Posts</a> / <time datetime="2021-09-02T00:00:00+05:30" class="post-date">02 Sep 2021</time> <article class="post"> <h1 class="post-title">An Introduction To The Confusion Matrix</h1> <p></p> <p class="post-description"><p>A confusion matrix is a tool used to summarize the performance and accuracy of a classification model in machine learning. It comes in handy after the data has been cleaned, processed, fed into a model, and has given out results. It helps in determining the effectiveness of the classification.</p> </p> <p><p>A confusion matrix is a table of four different combinations of actual and the predicted values and is an important step in calculating the recall, precision, and accuracy of the values, as well as AUC-ROC curves.</p> <p><img src="/blog/ConfusionMatrix/1.png" /></p> <p>● The target variable is binary, that is, either Positive or Negative</p> <p>● Actual values of the target variable are represented by the columns</p> <p>● Predicted values of the target variable are shown in the rows of the matrix</p> <p>The matrix has been divided into four parts:</p> <ol> <li>True Positive</li> <li>True Negative</li> <li>False Positive</li> <li>False Negative</li> </ol> <h2>True Positive (TP) </h2> <p>● The predicted value matches the actual value</p> <p>● The actual outcome was positive and the classifier predicted positive too</p> <h2>True Negative (TN) </h2> <p>● The predicted value matches the actual value</p> <p>● The actual outcome was negative and the model’s prediction was negative as well</p> <h2>False Positive (FP) – Type 1 error</h2> <p>● The predicted value was falsely predicted</p> <p>● The model predicted a positive value but the actual value was negative</p> <p>● Also known as the Type 1 error</p> <h2>False Negative (FN) – Type 2 error</h2> <p>● The predicted value was falsely predicted</p> <p>● The model predicted a positive value but the actual outcome was positive</p> <p>● Also known as the Type 2 error</p> <p><img src="/blog/ConfusionMatrix/2.png" /></p> <h2>How do we use the Matrix?</h2> <p>The confusion matrix helps in determining values that explain the results of the classifier through certain metrics to improve our understanding of its performance. These are:</p> <h2>Precision </h2> <p>Precision is the ratio of correct positive predictions to the total of all positive outcomes.</p> <p>It is also called Positive predictive value.</p> <p>Precision = TP/(TP+FP)</p> <h2>Recall</h2> <p>Recall is the ratio of the correct positive results to the total positive predictions.</p> <p>It is also called Sensitivity, Probability of Detection, True Positive Rate.</p> <p>Recall= TP/(TP+FN)</p> <h2>Accuracy</h2> <p>Accuracy is defined as the ratio of correct predictions by the total predictions.</p> <p>Accuracy = Correct Predictions/ Total Predictions</p> <p>In a confusion matrix, it can be derived using:</p> <p>Accuracy = (TP+TN)/(TP+TN+FP+FN)</p> <p>Accuracy is a handy metric for evaluation when all the classes are of equal importance. But this might not be the case if we are predicting if a patient has a fatal diagnosis or not. Here, False Positives are acceptable, but False Negatives are not.</p> <h2>ROC curve</h2> <p>A ROC curve (receiver operating characteristic curve) graphs the performance of a classification model at all classification thresholds. (Using thresholds: Say, if you want to compute TPR and FPR for the threshold equal to 0.6, you apply the model to each example, get the score, and, if the score &gt;=0.6, you predict the positive class; otherwise, the prediction is negative)</p> <p>It plots 2 parameters:</p> <p><b>True positive rate</b> (Recall)= TP/(TP+FN)</p> <p><b>False Positive rate</b>= FP/(FP+TN)</p> <p><img src="/blog/ConfusionMatrix/3.png" /></p> <p>Lowering the threshold predicts more items as positive, thus increasing both False Positives and True Positives in the outcome.</p> <h2>AUC</h2> <p>AUC stands for <b>Area under the ROC</b> Curve. It provides an average measure of performance across all possible probability thresholds of the results.</p> <p>The higher the area under the ROC curve (AUC), the better the model and the more efficient the classifier. A perfect model would have an area of 1. Usually, if your model is efficient, you obtain a good performance class by selecting the value of the threshold whose TPR tends to 1 while FPR inches closer to 0.</p> <h2>An Example of the Confusion Matrix</h2> <p>Suppose we have 165 patients being tested for Covid-19, and have gotten the following results from the tests:</p> <p><img src="/blog/ConfusionMatrix/1.png" /></p> <p>These are the most important metrics that we derive from the matrix:</p> <p><b>Accuracy:</b> Overall, how often is the test correctly predicting the patient’s diagnosis?</p> <p>(TP+TN)/Total = (100+50)/165 = <b>0.91</b></p> <p><b>Misclassification Rate:</b> Overall, how often is it wrong?</p> <p>(FP+FN)/total = (10+5)/165 = <b>0.09</b></p> <p>It is also equal to (1-Accuracy), and is also known as the “Error Rate”.</p> <p><b>True Positive Rate:</b> When it’s actually positive, how often does it predict positive?</p> <p>TP/(TP+FP) = 100/105 = <b>0.95</b></p> <p>We’ve discussed this earlier, also known as “Sensitivity” or “Recall”.</p> <p><b>False Positive Rate:</b> When it’s actually negative, how often does the test predict positive?</p> <p>FP/(TN+FN) = 10/60 = <b>0.17</b></p> <p><b>True Negative Rate:</b> When it’s actually negative, how often does it give a negative outcome?</p> <p>TN/(TN+FP) = 50/60 = <b>0.83</b></p> <p>True Negative Rate is equal to (1-False Positive Rate), and is called “Specificity”.</p> <p><b>Precision:</b> When the outcome is positive, how often is it correct?</p> <p>TP/predicted yes = 100/110 = <b>0.91</b></p> <p><b>Prevalence:</b> How often does the test predict positive?</p> <p>TP+FN/Total = 105/165 = <b>0.64</b></p> <p>These metrics help us in understanding the results better as well as the efficiency of the classification.</p> <h2>Conclusion</h2> <p>The Confusion Matrix and the metrics derived from it are really helpful in analyzing the data as well as the algorithm used for classification, like the following.</p> <p>● ROCs define the trade-off between the TPR and FPR for a predictive model using different probability thresholds.</p> <p>● Precision-Recall curves summarize the trade-off between the TPR and the positive prediction efficiency for a model using different probability thresholds.</p> <p>● ROCs are suitable when the observations are balanced between each class, whereas precision-recall curves are more suitable when the data is imbalanced.</p> </p> <p><strong>Recommended</strong> <a href="/blog/Benfords-Law/">» Benford's Law </a><br> </p> </article> </div> </main> <!-- <footer id="footer"> <div class="row"> <div class="col-xs-12 col-sm-3 footer-social center-xs"> <small class="social"> <div> <span class="icons"> <a href="https://facebook.com/nucleus.cbs"> <span class="icon icon--instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M22.675 0h-21.35c-.732 0-1.325.593-1.325 1.325v21.351c0 .731.593 1.324 1.325 1.324h11.495v-9.294h-3.128v-3.622h3.128v-2.671c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12v9.293h6.116c.73 0 1.323-.593 1.323-1.325v-21.35c0-.732-.593-1.325-1.325-1.325z"/></svg></span></a> <a href="https://www.linkedin.com/company/nucleus-cbs/"> <span class="icon icon--twitter"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg></span></a> <a href="https://instagram.com/nucleus.cbs"> <span class="icon icon--instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg></span></a> </span> <form action="https://formspree.io/xeqrjbrn" method="POST"> <input type="email" name="replyto" id="Email" placeholder="Mailing List Email" class="email" required> <input type="hidden" name="_next" value="https://nucleuscbs.github.io/thanks/" /> <input type="submit" value="Join"> </form> </div> </small> </div> <div class="col-xs-12 col-sm-6 footer"> <h1 style="color: #fff">Collegiate Entrepreneurs Organisation</h1> <h1>Delhi University</h1> </div> <div class="col-xs-12 col-sm-3 footer"> <a href="/noprivacy/">Privacy Policy</a> | &copy; CEO, Delhi University </div> </div> </footer> --> <footer id="footer" style=" display:grid; grid-template-columns: repeat(20,5%); grid-template-rows: repeat(20,5%); height: 40vh; "> <div class="footer-social footer-layout-social"> <small class="social"> <div> <span class="icons"> <a href="https://facebook.com/nucleus.cbs"> <span class="icon icon--instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M22.675 0h-21.35c-.732 0-1.325.593-1.325 1.325v21.351c0 .731.593 1.324 1.325 1.324h11.495v-9.294h-3.128v-3.622h3.128v-2.671c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12v9.293h6.116c.73 0 1.323-.593 1.323-1.325v-21.35c0-.732-.593-1.325-1.325-1.325z"/></svg></span></a> <a href="https://www.linkedin.com/company/nucleus-cbs/"> <span class="icon icon--twitter"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg></span></a> <a href="https://instagram.com/nucleus.cbs"> <span class="icon icon--instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg></span></a> </span> <form action="https://formspree.io/xeqrjbrn" method="POST"> <input type="email" name="replyto" id="Email" placeholder="Mailing List Email" class="email" required> <input type="hidden" name="_next" value="https://nucleuscbs.github.io/thanks/" /> <input type="submit" value="Join"> </form> </div> </small> </div> <div class="footer-layout-text"> <h1 style="color: #000; margin:0; line-height: 1.2; font-family: Gotham XNarrow;letter-spacing: 0.05rem;">THE ANALYTICS BAY</h1> <img src="/nucleus.png" style="height:50px;width:auto;margin-left:0;"> <!-- <h1 style="line-height: 1.2;font-family: Gotham XNarrow;letter-spacing: 0.05rem; font-size: 3rem;color:#000">Nucleus, the analytics society of SSCBS</h1> --> </div> <div class="footer-layout-copy"> &copy; The Analytics Bay </div> </footer> <script async src=""></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); </script> <!-- Rotator --> </body>
